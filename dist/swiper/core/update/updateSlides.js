import{setCSSProperty}from"../../shared/utils.js";export default function updateSlides(){const e=this;function t(t){return e.isHorizontal()?t:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[t]}function s(e,s){return parseFloat(e.getPropertyValue(t(s))||0)}const i=e.params,{$wrapperEl:r,size:n,rtlTranslate:a,wrongRTL:l}=e,o=e.virtual&&i.virtual.enabled,d=o?e.virtual.slides.length:e.slides.length,p=r.children(`.${e.params.slideClass}`),f=o?e.virtual.slides.length:p.length;let g=[];const h=[],c=[];let u=i.slidesOffsetBefore;"function"==typeof u&&(u=i.slidesOffsetBefore.call(e));let m=i.slidesOffsetAfter;"function"==typeof m&&(m=i.slidesOffsetAfter.call(e));const w=e.snapGrid.length,S=e.slidesGrid.length;let y=i.spaceBetween,z=-u,b=0,v=0;if(void 0===n)return;"string"==typeof y&&y.indexOf("%")>=0&&(y=parseFloat(y.replace("%",""))/100*n),e.virtualSize=-y,a?p.css({marginLeft:"",marginBottom:"",marginTop:""}):p.css({marginRight:"",marginBottom:"",marginTop:""}),i.centeredSlides&&i.cssMode&&(setCSSProperty(e.wrapperEl,"--swiper-centered-offset-before",""),setCSSProperty(e.wrapperEl,"--swiper-centered-offset-after",""));const B=i.grid&&i.grid.rows>1&&e.grid;let G;B&&e.grid.initSlides(f);const P="auto"===i.slidesPerView&&i.breakpoints&&Object.keys(i.breakpoints).filter((e=>void 0!==i.breakpoints[e].slidesPerView)).length>0;for(let r=0;r<f;r+=1){G=0;const a=p.eq(r);if(B&&e.grid.updateSlide(r,a,f,t),"none"!==a.css("display")){if("auto"===i.slidesPerView){P&&(p[r].style[t("width")]="");const n=getComputedStyle(a[0]),l=a[0].style.transform,o=a[0].style.webkitTransform;if(l&&(a[0].style.transform="none"),o&&(a[0].style.webkitTransform="none"),i.roundLengths)G=e.isHorizontal()?a.outerWidth(!0):a.outerHeight(!0);else{const e=s(n,"width"),t=s(n,"padding-left"),i=s(n,"padding-right"),r=s(n,"margin-left"),l=s(n,"margin-right"),o=n.getPropertyValue("box-sizing");if(o&&"border-box"===o)G=e+r+l;else{const{clientWidth:s,offsetWidth:n}=a[0];G=e+t+i+r+l+(n-s)}}l&&(a[0].style.transform=l),o&&(a[0].style.webkitTransform=o),i.roundLengths&&(G=Math.floor(G))}else G=(n-(i.slidesPerView-1)*y)/i.slidesPerView,i.roundLengths&&(G=Math.floor(G)),p[r]&&(p[r].style[t("width")]=`${G}px`);p[r]&&(p[r].swiperSlideSize=G),c.push(G),i.centeredSlides?(z=z+G/2+b/2+y,0===b&&0!==r&&(z=z-n/2-y),0===r&&(z=z-n/2-y),Math.abs(z)<.001&&(z=0),i.roundLengths&&(z=Math.floor(z)),v%i.slidesPerGroup==0&&g.push(z),h.push(z)):(i.roundLengths&&(z=Math.floor(z)),(v-Math.min(e.params.slidesPerGroupSkip,v))%e.params.slidesPerGroup==0&&g.push(z),h.push(z),z=z+G+y),e.virtualSize+=G+y,b=G,v+=1}}if(e.virtualSize=Math.max(e.virtualSize,n)+m,a&&l&&("slide"===i.effect||"coverflow"===i.effect)&&r.css({width:`${e.virtualSize+i.spaceBetween}px`}),i.setWrapperSize&&r.css({[t("width")]:`${e.virtualSize+i.spaceBetween}px`}),B&&e.grid.updateWrapperSize(G,g,t),!i.centeredSlides){const t=[];for(let s=0;s<g.length;s+=1){let r=g[s];i.roundLengths&&(r=Math.floor(r)),g[s]<=e.virtualSize-n&&t.push(r)}g=t,Math.floor(e.virtualSize-n)-Math.floor(g[g.length-1])>1&&g.push(e.virtualSize-n)}if(0===g.length&&(g=[0]),0!==i.spaceBetween){const s=e.isHorizontal()&&a?"marginLeft":t("marginRight");p.filter(((e,t)=>!i.cssMode||t!==p.length-1)).css({[s]:`${y}px`})}if(i.centeredSlides&&i.centeredSlidesBounds){let e=0;c.forEach((t=>{e+=t+(i.spaceBetween?i.spaceBetween:0)})),e-=i.spaceBetween;const t=e-n;g=g.map((e=>e<0?-u:e>t?t+m:e))}if(i.centerInsufficientSlides){let e=0;if(c.forEach((t=>{e+=t+(i.spaceBetween?i.spaceBetween:0)})),e-=i.spaceBetween,e<n){const t=(n-e)/2;g.forEach(((e,s)=>{g[s]=e-t})),h.forEach(((e,s)=>{h[s]=e+t}))}}if(Object.assign(e,{slides:p,snapGrid:g,slidesGrid:h,slidesSizesGrid:c}),i.centeredSlides&&i.cssMode&&!i.centeredSlidesBounds){setCSSProperty(e.wrapperEl,"--swiper-centered-offset-before",-g[0]+"px"),setCSSProperty(e.wrapperEl,"--swiper-centered-offset-after",e.size/2-c[c.length-1]/2+"px");const t=-e.snapGrid[0],s=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map((e=>e+t)),e.slidesGrid=e.slidesGrid.map((e=>e+s))}f!==d&&e.emit("slidesLengthChange"),g.length!==w&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),h.length!==S&&e.emit("slidesGridLengthChange"),i.watchSlidesProgress&&e.updateSlidesOffset()}