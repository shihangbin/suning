import classesToSelector from"../../shared/classes-to-selector.js";import $ from"../../shared/dom.js";export default function A11y({swiper:e,extendParams:a,on:n}){a({a11y:{enabled:!0,notificationClass:"swiper-notification",prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",slideLabelMessage:"{{index}} / {{slidesLength}}",containerMessage:null,containerRoleDescriptionMessage:null,itemRoleDescriptionMessage:null,slideRole:"group"}});let i=null;function t(e){const a=i;0!==a.length&&(a.html(""),a.html(e))}function s(e){e.attr("tabIndex","0")}function l(e){e.attr("tabIndex","-1")}function o(e,a){e.attr("role",a)}function r(e,a){e.attr("aria-roledescription",a)}function p(e,a){e.attr("aria-label",a)}function g(e){e.attr("aria-disabled",!0)}function c(e){e.attr("aria-disabled",!1)}function d(a){if(13!==a.keyCode&&32!==a.keyCode)return;const n=e.params.a11y,i=$(a.target);e.navigation&&e.navigation.$nextEl&&i.is(e.navigation.$nextEl)&&(e.isEnd&&!e.params.loop||e.slideNext(),e.isEnd?t(n.lastSlideMessage):t(n.nextSlideMessage)),e.navigation&&e.navigation.$prevEl&&i.is(e.navigation.$prevEl)&&(e.isBeginning&&!e.params.loop||e.slidePrev(),e.isBeginning?t(n.firstSlideMessage):t(n.prevSlideMessage)),e.pagination&&i.is(classesToSelector(e.params.pagination.bulletClass))&&i[0].click()}function u(){if(e.params.loop||e.params.rewind||!e.navigation)return;const{$nextEl:a,$prevEl:n}=e.navigation;n&&n.length>0&&(e.isBeginning?(g(n),l(n)):(c(n),s(n))),a&&a.length>0&&(e.isEnd?(g(a),l(a)):(c(a),s(a)))}function f(){return e.pagination&&e.pagination.bullets&&e.pagination.bullets.length}function m(){return f()&&e.params.pagination.clickable}const v=(e,a,n)=>{s(e),"BUTTON"!==e[0].tagName&&(o(e,"button"),e.on("keydown",d)),p(e,n),function(e,a){e.attr("aria-controls",a)}(e,a)};function b(){const a=e.params.a11y;e.$el.append(i);const n=e.$el;a.containerRoleDescriptionMessage&&r(n,a.containerRoleDescriptionMessage),a.containerMessage&&p(n,a.containerMessage);const t=e.$wrapperEl,s=t.attr("id")||`swiper-wrapper-${function(e=16){return"x".repeat(e).replace(/x/g,(()=>Math.round(16*Math.random()).toString(16)))}(16)}`,l=e.params.autoplay&&e.params.autoplay.enabled?"off":"polite";var g;g=s,t.attr("id",g),function(e,a){e.attr("aria-live",a)}(t,l),a.itemRoleDescriptionMessage&&r($(e.slides),a.itemRoleDescriptionMessage),o($(e.slides),a.slideRole);const c=e.params.loop?e.slides.filter((a=>!a.classList.contains(e.params.slideDuplicateClass))).length:e.slides.length;let u,f;e.slides.each(((n,i)=>{const t=$(n),s=e.params.loop?parseInt(t.attr("data-swiper-slide-index"),10):i;p(t,a.slideLabelMessage.replace(/\{\{index\}\}/,s+1).replace(/\{\{slidesLength\}\}/,c))})),e.navigation&&e.navigation.$nextEl&&(u=e.navigation.$nextEl),e.navigation&&e.navigation.$prevEl&&(f=e.navigation.$prevEl),u&&u.length&&v(u,s,a.nextSlideMessage),f&&f.length&&v(f,s,a.prevSlideMessage),m()&&e.pagination.$el.on("keydown",classesToSelector(e.params.pagination.bulletClass),d)}n("beforeInit",(()=>{i=$(`<span class="${e.params.a11y.notificationClass}" aria-live="assertive" aria-atomic="true"></span>`)})),n("afterInit",(()=>{e.params.a11y.enabled&&(b(),u())})),n("toEdge",(()=>{e.params.a11y.enabled&&u()})),n("fromEdge",(()=>{e.params.a11y.enabled&&u()})),n("paginationUpdate",(()=>{e.params.a11y.enabled&&function(){const a=e.params.a11y;f()&&e.pagination.bullets.each((n=>{const i=$(n);e.params.pagination.clickable&&(s(i),e.params.pagination.renderBullet||(o(i,"button"),p(i,a.paginationBulletMessage.replace(/\{\{index\}\}/,i.index()+1)))),i.is(`.${e.params.pagination.bulletActiveClass}`)?i.attr("aria-current","true"):i.removeAttr("aria-current")}))}()})),n("destroy",(()=>{e.params.a11y.enabled&&function(){let a,n;i&&i.length>0&&i.remove(),e.navigation&&e.navigation.$nextEl&&(a=e.navigation.$nextEl),e.navigation&&e.navigation.$prevEl&&(n=e.navigation.$prevEl),a&&a.off("keydown",d),n&&n.off("keydown",d),m()&&e.pagination.$el.off("keydown",classesToSelector(e.params.pagination.bulletClass),d)}()}))}