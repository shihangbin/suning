import{getWindow,getDocument}from"ssr-window";import $ from"../../shared/dom.js";export default function HashNavigation({swiper:a,extendParams:t,emit:e,on:s}){let i=!1;const h=getDocument(),n=getWindow();t({hashNavigation:{enabled:!1,replaceState:!1,watchState:!1}});const o=()=>{e("hashChange");const t=h.location.hash.replace("#","");if(t!==a.slides.eq(a.activeIndex).attr("data-hash")){const e=a.$wrapperEl.children(`.${a.params.slideClass}[data-hash="${t}"]`).index();if(void 0===e)return;a.slideTo(e)}},r=()=>{if(i&&a.params.hashNavigation.enabled)if(a.params.hashNavigation.replaceState&&n.history&&n.history.replaceState)n.history.replaceState(null,null,`#${a.slides.eq(a.activeIndex).attr("data-hash")}`||""),e("hashSet");else{const t=a.slides.eq(a.activeIndex),s=t.attr("data-hash")||t.attr("data-history");h.location.hash=s||"",e("hashSet")}};s("init",(()=>{a.params.hashNavigation.enabled&&(()=>{if(!a.params.hashNavigation.enabled||a.params.history&&a.params.history.enabled)return;i=!0;const t=h.location.hash.replace("#","");if(t){const e=0;for(let s=0,i=a.slides.length;s<i;s+=1){const i=a.slides.eq(s);if((i.attr("data-hash")||i.attr("data-history"))===t&&!i.hasClass(a.params.slideDuplicateClass)){const t=i.index();a.slideTo(t,e,a.params.runCallbacksOnInit,!0)}}}a.params.hashNavigation.watchState&&$(n).on("hashchange",o)})()})),s("destroy",(()=>{a.params.hashNavigation.enabled&&a.params.hashNavigation.watchState&&$(n).off("hashchange",o)})),s("transitionEnd _freeModeNoMomentumRelease",(()=>{i&&r()})),s("slideChange",(()=>{i&&a.params.cssMode&&r()}))}