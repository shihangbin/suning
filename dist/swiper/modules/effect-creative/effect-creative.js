import createShadow from"../../shared/create-shadow.js";import effectInit from"../../shared/effect-init.js";import effectTarget from"../../shared/effect-target.js";import effectVirtualTransitionEnd from"../../shared/effect-virtual-transition-end.js";export default function EffectCreative({swiper:e,extendParams:t,on:r}){t({creativeEffect:{transformEl:null,limitProgress:1,shadowPerProgress:!1,progressMultiplier:1,perspective:!0,prev:{translate:[0,0,0],rotate:[0,0,0],opacity:1,scale:1},next:{translate:[0,0,0],rotate:[0,0,0],opacity:1,scale:1}}});const s=e=>"string"==typeof e?e:`${e}px`;effectInit({effect:"creative",swiper:e,on:r,setTranslate:()=>{const{slides:t,$wrapperEl:r,slidesSizesGrid:a}=e,i=e.params.creativeEffect,{progressMultiplier:o}=i,n=e.params.centeredSlides;if(n){const t=a[0]/2-e.params.slidesOffsetBefore||0;r.transform(`translateX(calc(50% - ${t}px))`)}for(let r=0;r<t.length;r+=1){const a=t.eq(r),l=a[0].progress,c=Math.min(Math.max(a[0].progress,-i.limitProgress),i.limitProgress);let f=c;n||(f=Math.min(Math.max(a[0].originalProgress,-i.limitProgress),i.limitProgress));const p=a[0].swiperSlideOffset,d=[e.params.cssMode?-p-e.translate:-p,0,0],m=[0,0,0];let h=!1;e.isHorizontal()||(d[1]=d[0],d[0]=0);let g={translate:[0,0,0],rotate:[0,0,0],scale:1,opacity:1};c<0?(g=i.next,h=!0):c>0&&(g=i.prev,h=!0),d.forEach(((e,t)=>{d[t]=`calc(${e}px + (${s(g.translate[t])} * ${Math.abs(c*o)}))`})),m.forEach(((e,t)=>{m[t]=g.rotate[t]*Math.abs(c*o)})),a[0].style.zIndex=-Math.abs(Math.round(l))+t.length;const w=d.join(", "),M=`rotateX(${m[0]}deg) rotateY(${m[1]}deg) rotateZ(${m[2]}deg)`,v=f<0?`scale(${1+(1-g.scale)*f*o})`:`scale(${1-(1-g.scale)*f*o})`,P=f<0?1+(1-g.opacity)*f*o:1-(1-g.opacity)*f*o,$=`translate3d(${w}) ${M} ${v}`;if(h&&g.shadow||!h){let e=a.children(".swiper-slide-shadow");if(0===e.length&&g.shadow&&(e=createShadow(i,a)),e.length){const t=i.shadowPerProgress?c*(1/i.limitProgress):c;e[0].style.opacity=Math.min(Math.max(Math.abs(t),0),1)}}const E=effectTarget(i,a);E.transform($).css({opacity:P}),g.origin&&E.css("transform-origin",g.origin)}},setTransition:t=>{const{transformEl:r}=e.params.creativeEffect;(r?e.slides.find(r):e.slides).transition(t).find(".swiper-slide-shadow").transition(t),effectVirtualTransitionEnd({swiper:e,duration:t,transformEl:r,allSlides:!0})},perspective:()=>e.params.creativeEffect.perspective,overwriteParams:()=>({watchSlidesProgress:!0,virtualTranslate:!e.params.cssMode})})}