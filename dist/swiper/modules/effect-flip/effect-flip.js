import createShadow from"../../shared/create-shadow.js";import effectInit from"../../shared/effect-init.js";import effectTarget from"../../shared/effect-target.js";import effectVirtualTransitionEnd from"../../shared/effect-virtual-transition-end.js";export default function EffectFlip({swiper:t,extendParams:e,on:s}){e({flipEffect:{slideShadows:!0,limitRotation:!0,transformEl:null}});effectInit({effect:"flip",swiper:t,on:s,setTranslate:()=>{const{slides:e,rtlTranslate:s}=t,i=t.params.flipEffect;for(let a=0;a<e.length;a+=1){const r=e.eq(a);let o=r[0].progress;t.params.flipEffect.limitRotation&&(o=Math.max(Math.min(r[0].progress,1),-1));const l=r[0].swiperSlideOffset;let n=-180*o,f=0,d=t.params.cssMode?-l-t.translate:-l,p=0;if(t.isHorizontal()?s&&(n=-n):(p=d,d=0,f=-n,n=0),r[0].style.zIndex=-Math.abs(Math.round(o))+e.length,i.slideShadows){let e=t.isHorizontal()?r.find(".swiper-slide-shadow-left"):r.find(".swiper-slide-shadow-top"),s=t.isHorizontal()?r.find(".swiper-slide-shadow-right"):r.find(".swiper-slide-shadow-bottom");0===e.length&&(e=createShadow(i,r,t.isHorizontal()?"left":"top")),0===s.length&&(s=createShadow(i,r,t.isHorizontal()?"right":"bottom")),e.length&&(e[0].style.opacity=Math.max(-o,0)),s.length&&(s[0].style.opacity=Math.max(o,0))}const h=`translate3d(${d}px, ${p}px, 0px) rotateX(${f}deg) rotateY(${n}deg)`;effectTarget(i,r).transform(h)}},setTransition:e=>{const{transformEl:s}=t.params.flipEffect;(s?t.slides.find(s):t.slides).transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),effectVirtualTransitionEnd({swiper:t,duration:e,transformEl:s})},perspective:()=>!0,overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!t.params.cssMode})})}