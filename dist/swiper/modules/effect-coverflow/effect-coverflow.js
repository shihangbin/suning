import createShadow from"../../shared/create-shadow.js";import effectInit from"../../shared/effect-init.js";import effectTarget from"../../shared/effect-target.js";export default function EffectCoverflow({swiper:e,extendParams:t,on:s}){t({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0,transformEl:null}});effectInit({effect:"coverflow",swiper:e,on:s,setTranslate:()=>{const{width:t,height:s,slides:a,slidesSizesGrid:r}=e,o=e.params.coverflowEffect,i=e.isHorizontal(),d=e.translate,f=i?t/2-d:s/2-d,l=i?o.rotate:-o.rotate,h=o.depth;for(let e=0,t=a.length;e<t;e+=1){const t=a.eq(e),s=r[e],d=(f-t[0].swiperSlideOffset-s/2)/s*o.modifier;let n=i?l*d:0,c=i?0:l*d,w=-h*Math.abs(d),p=o.stretch;"string"==typeof p&&-1!==p.indexOf("%")&&(p=parseFloat(o.stretch)/100*s);let m=i?0:p*d,g=i?p*d:0,b=1-(1-o.scale)*Math.abs(d);Math.abs(g)<.001&&(g=0),Math.abs(m)<.001&&(m=0),Math.abs(w)<.001&&(w=0),Math.abs(n)<.001&&(n=0),Math.abs(c)<.001&&(c=0),Math.abs(b)<.001&&(b=0);const M=`translate3d(${g}px,${m}px,${w}px)  rotateX(${c}deg) rotateY(${n}deg) scale(${b})`;if(effectTarget(o,t).transform(M),t[0].style.zIndex=1-Math.abs(Math.round(d)),o.slideShadows){let e=i?t.find(".swiper-slide-shadow-left"):t.find(".swiper-slide-shadow-top"),s=i?t.find(".swiper-slide-shadow-right"):t.find(".swiper-slide-shadow-bottom");0===e.length&&(e=createShadow(o,t,i?"left":"top")),0===s.length&&(s=createShadow(o,t,i?"right":"bottom")),e.length&&(e[0].style.opacity=d>0?d:0),s.length&&(s[0].style.opacity=-d>0?-d:0)}}},setTransition:t=>{const{transformEl:s}=e.params.coverflowEffect;(s?e.slides.find(s):e.slides).transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t)},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}